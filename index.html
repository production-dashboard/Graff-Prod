<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GRAFF 8260667OG Dashboard</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      background-color: white;
    }

    table {
      border-collapse: collapse;
      width: 98vw;
      font-size: 0.9vw;
      table-layout: fixed;
    }

    th, td {
      border: 1px solid #ccc;
      text-align: center;
      padding: 0.3em;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    th {
      white-space: normal;
      word-wrap: break-word;
      font-size: 0.75vw;
    }

    td:nth-child(2) {
      text-align: left;
      white-space: nowrap;
    }

    @media screen and (max-width: 600px) {
      table {
        font-size: 2vw;
      }
    }
  </style>
</head>
<body>
  <div id="data"></div>
  <script>
    function fetchSheetData() {
      const sheetID = "1ZvZvqtDFkRb2pBVM7gcZz4J2iuFURly6Oj0KD7Itb3k";
      const sheetName = "GRAFF 8260667OG Signoff Samples";
      const query = encodeURIComponent("SELECT A, B, K, L, M, N, O, P, Q, R, S, T, U, V, W, X, Y, Z, AA, AB, AC, AD, AE, AF, AG, AH, AI, AJ, AK, AL OFFSET 5");
      const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?sheet=${sheetName}&tq=${query}`;

      fetch(url)
        .then(res => res.text())
        .then(rep => {
          const jsonData = JSON.parse(rep.substring(47).slice(0, -2));
          const table = document.createElement("table");
          const thead = document.createElement("thead");
          const tbody = document.createElement("tbody");

          const rows = jsonData.table.rows;

          // Use first row as header
          const headerRow = document.createElement("tr");
          rows[0].c.forEach((cell, idx) => {
            const th = document.createElement("th");
            th.textContent = cell ? cell.v : "";
            headerRow.appendChild(th);
          });
          thead.appendChild(headerRow);

          // Rest as data rows
          for (let i = 1; i < rows.length; i++) {
            const tr = document.createElement("tr");
            rows[i].c.forEach((cell, j) => {
              const td = document.createElement("td");
              td.textContent = cell ? cell.v : "";
              tr.appendChild(td);
            });
            tbody.appendChild(tr);
          }

          table.appendChild(thead);
          table.appendChild(tbody);
          const container = document.getElementById("data");
          container.innerHTML = "";
          container.appendChild(table);
        })
        .catch(error => {
          console.error("Error fetching data:", error);
          document.getElementById("data").innerHTML = "<p style='color:red;'>⚠️ Failed to load data</p>";
        });
    }

    fetchSheetData();
    setInterval(fetchSheetData, 60000); // Refresh every 60 seconds
  </script>
</body>
</html>
